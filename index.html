<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 6 ICT Diagnostic Assessment</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(to bottom right, #008080, #004d4d);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            background-color: rgba(0, 0, 0, 0.5);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            width: 80%;
            max-width: 800px;
            margin: 20px;
        }

        .logo {
            display: block;
            margin: 0 auto 20px auto;
            max-width: 150px;
        }

        .title-page, .quiz-page, .result-page {
            display: none;
            text-align: center;
        }

        .title-page {
            display: block;
        }

        h1, h2, h3 {
            color: #ccff90;
        }

        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .input-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background-color: #008080;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover:not(:disabled) {
            background-color: #004d4d;
        }
        
        button:disabled {
            background-color: #555;
            cursor: not-allowed;
        }

        .question {
            margin-bottom: 20px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            text-align: left;
        }

        .options label {
            display: block;
            margin: 10px 0;
            cursor: pointer;
        }

        .matching-pair {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .matching-pair select {
            width: 45%;
            padding: 5px;
            border-radius: 5px;
        }

        .report-section {
            text-align: left;
            margin-top: 20px;
        }

        .report-section .feedback-section {
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .report-section .strength {
            background-color: #006400; /* Darker green */
        }
        
        .report-section .weakness {
            background-color: #8B0000; /* Darker red */
        }
        
        .report-section .feedback-box {
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* Modal styling */
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: #333;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 400px;
            text-align: center;
        }

        .modal-content button {
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title-page" id="title-page">
            <img src="https://storage.googleapis.com/yaschools/schools-logo/148544809806-19-2025-10-34-06.jpg" alt="School Logo" class="logo">
            <h1>Grade 6 â€“ ICT<br>Diagnostic Assessment</h1>
            <p>Teacher Name: Mr. Usama Ibnzaid</p>
            <div class="input-group">
                <label for="studentName">Student Full Name:</label>
                <input type="text" id="studentName" required>
            </div>
            <button onclick="startAssessment()">Start Assessment</button>
        </div>

        <div class="quiz-page" id="quiz-page">
            <h2 id="question-counter">Question 1 of 50</h2>
            <div id="question-container"></div>
            <button onclick="previousQuestion()" id="previous-button" style="display: none;">Previous</button>
            <button onclick="nextQuestion()" id="next-button">Next</button>
            <button onclick="submitAssessment()" style="display: none;" id="submit-button">Submit Assessment</button>
        </div>

        <div class="result-page" id="result-page">
            <h2>Assessment Report</h2>
            <p>Student: <span id="student-name-result"></span></p>
            <p>Your Score: <span id="score"></span> / 50</p>
            <div class="report-section">
                <h3>Strengths & Weaknesses</h3>
                <div id="strengths-weaknesses"></div>
                <h3>Constructive Feedback & Recommendations</h3>
                <p id="feedback"></p>
                <h3>Formal Written Report to Parent/Guardian</h3>
                <p id="parent-report"></p>
            </div>
            <button onclick="downloadReport()">Download the Report</button>
        </div>
    </div>

    <script>
        // Data for the 50-question quiz.
        const quizData = [
            { type: "multiple-choice", question: "1. Which of these is a computer part you can touch?", options: ["Software", "Hardware", "Data", "Virus"], answer: "Hardware", topic: "Hardware" },
            { type: "true-false", question: "2. The monitor is used for typing letters.", answer: "False", topic: "Hardware" },
            { type: "fill-in-the-blank", question: "3. The main screen you see when you turn on a computer is called the _________.", answer: "desktop", topic: "Software" },
            { type: "matching", question: "4. Match the device to its type.", pairs: [{ left: "Keyboard", right: ["Input Device", "Output Device"] }, { left: "Printer", right: ["Output Device", "Input Device"] }], answers: { "Keyboard": "Input Device", "Printer": "Output Device" }, topic: "Hardware" },
            { type: "short-answer", question: "5. What is an 'app' short for?", answer: "Application", topic: "Software" },
            { type: "case-study", question: "6. **Case Study:** A student wants to draw a picture on the computer. What type of program would they use?", answer: "A drawing or painting program.", topic: "Software" },
            { type: "multiple-choice", question: "7. Which of these is a safe password?", options: ["123456", "password", "MyDogSparky", "f0rty$even#"], answer: "f0rty$even#", topic: "Digital Citizenship" },
            { type: "true-false", question: "8. A tablet is a type of computer.", answer: "True", topic: "Hardware" },
            { type: "fill-in-the-blank", question: "9. To find a website, you type its _________ into the address bar.", answer: "URL", topic: "Internet" },
            { type: "matching", question: "10. Match the action to the program.", pairs: [{ left: "Typing a story", right: ["Word Processor", "Web Browser"] }, { left: "Finding a website", right: ["Web Browser", "Word Processor"] }], answers: { "Typing a story": "Word Processor", "Finding a website": "Web Browser" }, topic: "Software" },
            { type: "short-answer", question: "11. What is the main purpose of a 'search engine'?", answer: "To help you find information on the internet.", topic: "Internet" },
            { type: "case-study", question: "12. **Case Study:** A student finds a funny picture online and wants to share it with a friend. What is the safest way to do this?", answer: "By asking an adult for help.", topic: "Digital Citizenship" },
            { type: "multiple-choice", question: "13. What is a 'digital footprint'?", options: ["A mark left by a computer mouse", "The trail of data we leave online", "A type of keyboard", "A computer game"], answer: "The trail of data we leave online", topic: "Digital Citizenship" },
            { type: "true-false", question: "14. A computer mouse is an input device.", answer: "True", topic: "Hardware" },
            { type: "fill-in-the-blank", question: "15. The 'brain' of the computer is the _________.", answer: "CPU", topic: "Hardware" },
            { type: "matching", question: "16. Match the term to its definition.", pairs: [{ left: "Monitor", right: ["An output device that shows images", "An input device for typing"] }, { left: "Keyboard", right: ["An input device for typing", "An output device that shows images"] }], answers: { "Monitor": "An output device that shows images", "Keyboard": "An input device for typing" }, topic: "Hardware" },
            { type: "short-answer", question: "17. What does 'copy and paste' do?", answer: "It duplicates text or a picture from one place to another.", topic: "Software" },
            { type: "case-study", question: "18. **Case Study:** A student is working on a school project and needs to save their work. What button or command should they use?", answer: "The 'Save' or 'Save As' command.", topic: "File Management" },
            { type: "multiple-choice", question: "19. Which of these is a way to stay safe online?", options: ["Giving out personal information", "Talking to strangers online", "Using a strong password", "Clicking on every link"], answer: "Using a strong password", topic: "Digital Citizenship" },
            { type: "true-false", question: "20. A file is a collection of data stored on a computer.", answer: "True", topic: "File Management" },
            { type: "fill-in-the-blank", question: "21. A _________ is a program that lets you surf the internet.", answer: "web browser", topic: "Internet" },
            { type: "matching", question: "22. Match the device to what it is used for.", pairs: [{ left: "Speaker", right: ["Listening to sound", "Drawing on a screen"] }, { left: "Webcam", right: ["Taking pictures or video", "Listening to sound"] }], answers: { "Speaker": "Listening to sound", "Webcam": "Taking pictures or video" }, topic: "Hardware" },
            { type: "short-answer", question: "23. What is an 'operating system'?", answer: "The main program that controls the computer's hardware and software.", topic: "Software" },
            { type: "case-study", question: "24. **Case Study:** A student wants to send a letter to their grandmother using a computer. What program would they most likely use?", answer: "A word processor like Microsoft Word or Google Docs.", topic: "Software" },
            { type: "multiple-choice", question: "25. Which of these is an example of a social media site?", options: ["Google", "Facebook", "Amazon", "Netflix"], answer: "Facebook", topic: "Internet" },
            { type: "true-false", question: "26. You should always open an email attachment from a sender you don't know.", answer: "False", topic: "Digital Citizenship" },
            { type: "fill-in-the-blank", question: "27. To make a document private, you can add a _________ to it.", answer: "password", topic: "Digital Citizenship" },
            { type: "matching", question: "28. Match the device to its category.", pairs: [{ left: "Microphone", right: ["Input Device", "Output Device"] }, { left: "Headphones", right: ["Output Device", "Input Device"] }], answers: { "Microphone": "Input Device", "Headphones": "Output Device" }, topic: "Hardware" },
            { type: "short-answer", question: "29. What is 'cyberbullying'?", answer: "Using technology to hurt or scare someone.", topic: "Digital Citizenship" },
            { type: "case-study", question: "30. **Case Study:** A student wants to make a video of their school trip. What device would they use to film it?", answer: "A digital camera, webcam, or a smartphone.", topic: "Hardware" },
            { type: "multiple-choice", question: "31. Which of these is a type of computer?", options: ["Refrigerator", "Desktop computer", "Lamp", "Chair"], answer: "Desktop computer", topic: "Hardware" },
            { type: "true-false", question: "32. The internet is the same thing as the World Wide Web.", answer: "False", topic: "Internet" },
            { type: "fill-in-the-blank", question: "33. A _________ is a folder that holds other files and folders.", answer: "folder", topic: "File Management" },
            { type: "matching", question: "34. Match the file type to its content.", pairs: [{ left: ".jpg", right: ["Picture file", "Text file"] }, { left: ".txt", right: ["Text file", "Picture file"] }], answers: { ".jpg": "Picture file", ".txt": "Text file" }, topic: "File Management" },
            { type: "short-answer", question: "35. What is the purpose of a 'backup'?", answer: "To make a copy of a file in case the original is lost or damaged.", topic: "File Management" },
            { type: "case-study", question: "36. **Case Study:** A student is working on a school project and needs to save their work. What button or command should they use?", answer: "The 'Save' or 'Save As' command.", topic: "File Management" },
            { type: "multiple-choice", question: "37. What is 'computer programming'?", options: ["Playing a game on the computer", "Giving instructions to a computer to solve a problem", "Typing a document", "Sending a message"], answer: "Giving instructions to a computer to solve a problem", topic: "Programming" },
            { type: "true-false", question: "38. All computers are connected to the internet.", answer: "False", topic: "Internet" },
            { type: "fill-in-the-blank", question: "39. The process of turning off your computer is called _________.", answer: "shutting down", topic: "Hardware" },
            { type: "matching", question: "40. Match the term to its meaning.", pairs: [{ left: "Download", right: ["To copy a file from the internet to your computer", "To send a file from your computer to the internet"] }, { left: "Upload", right: ["To send a file from your computer to the internet", "To copy a file from the internet to your computer"] }], answers: { "Download": "To copy a file from the internet to your computer", "Upload": "To send a file from your computer to the internet" }, topic: "Internet" },
            { type: "short-answer", question: "41. What is a 'virus' in a computer?", answer: "A harmful program that can damage your computer or steal your information.", topic: "Digital Citizenship" },
            { type: "case-study", question: "42. **Case Study:** A student wants to make a family tree. They need to put a picture and a name for each person. What kind of program would be best?", answer: "A presentation or diagram program.", topic: "Software" },
            { type: "multiple-choice", question: "43. What does 'Wi-Fi' stand for?", options: ["Wired Fidelity", "Wireless Fidelity", "Web Fire", "Web Filter"], answer: "Wireless Fidelity", topic: "Internet" },
            { type: "true-false", question: "44. You should share your personal information like your address or phone number online.", answer: "False", topic: "Digital Citizenship" },
            { type: "fill-in-the-blank", question: "45. The physical parts of a computer are called _________.", answer: "hardware", topic: "Hardware" },
            { type: "matching", question: "46. Match the device to its category.", pairs: [{ left: "Scanner", right: ["Input device", "Output device"] }, { left: "Monitor", right: ["Output device", "Input device"] }], answers: { "Scanner": "Input device", "Monitor": "Output device" }, topic: "Hardware" },
            { type: "short-answer", question: "47. What is 'netiquette'?", answer: "The set of rules for good behavior online.", topic: "Digital Citizenship" },
            { type: "case-study", question: "48. **Case Study:** A student needs to email a picture to their teacher. What command would they use in the email program?", answer: "The 'attach' or 'insert' command.", topic: "Internet" },
            { type: "multiple-choice", question: "49. Which of these is a way to protect your computer?", options: ["Installing antivirus software", "Clicking on pop-up ads", "Sharing your password", "Downloading files from unknown sources"], answer: "Installing antivirus software", topic: "Digital Citizenship" },
            { type: "true-false", question: "50. A program is a set of instructions that a computer can follow.", answer: "True", topic: "Programming" },
        ];
        
        // State variables for the quiz
        let currentQuestionIndex = 0;
        let score = 0;
        const userAnswers = {};
        let studentName = "";

        // Get DOM elements
        const titlePage = document.getElementById('title-page');
        const quizPage = document.getElementById('quiz-page');
        const resultPage = document.getElementById('result-page');
        const questionContainer = document.getElementById('question-container');
        const questionCounter = document.getElementById('question-counter');
        const submitButton = document.getElementById('submit-button');
        const nextButton = document.getElementById('next-button');
        const previousButton = document.getElementById('previous-button');

        /**
         * Starts the assessment, checks for student name, and displays the first question.
         */
        function startAssessment() {
            studentName = document.getElementById('studentName').value.trim();
            if (!studentName) {
                showModal("Please enter your full name to start the assessment.");
                return;
            }
            document.getElementById('student-name-result').textContent = studentName;
            titlePage.style.display = 'none';
            quizPage.style.display = 'block';
            loadQuestion();
        }

        /**
         * Renders the current question based on the `currentQuestionIndex`.
         */
        function loadQuestion() {
            if (currentQuestionIndex < 0) currentQuestionIndex = 0;
            if (currentQuestionIndex >= quizData.length) currentQuestionIndex = quizData.length - 1;

            const q = quizData[currentQuestionIndex];
            questionCounter.textContent = `Question ${currentQuestionIndex + 1} of ${quizData.length}`;
            questionContainer.innerHTML = '';
            
            const questionDiv = document.createElement('div');
            questionDiv.classList.add('question');
            
            let questionHTML = `<h4>${q.question}</h4>`;
            questionDiv.innerHTML = questionHTML;

            // Render different question types and add event listeners
            if (q.type === 'multiple-choice' || q.type === 'true-false') {
                const optionsDiv = document.createElement('div');
                optionsDiv.classList.add('options');
                (q.options || ["True", "False"]).forEach(option => {
                    const inputId = `q${currentQuestionIndex}-opt-${option.replace(/\s+/g, '-')}`;
                    optionsDiv.innerHTML += `
                        <label for="${inputId}">
                            <input type="radio" name="answer" id="${inputId}" value="${option}" onchange="checkAnswerStatus()"> ${option}
                        </label>
                    `;
                });
                questionDiv.appendChild(optionsDiv);
                // Pre-fill answer if it exists
                if (userAnswers[currentQuestionIndex]) {
                    const savedAnswer = userAnswers[currentQuestionIndex];
                    const selectedInput = document.querySelector(`input[name="answer"][value="${savedAnswer}"]`);
                    if (selectedInput) {
                        selectedInput.checked = true;
                    }
                }
            } else if (q.type === 'fill-in-the-blank' || q.type === 'short-answer' || q.type === 'case-study') {
                const input = document.createElement('input');
                input.type = 'text';
                input.placeholder = 'Type your answer here...';
                input.id = 'text-answer';
                input.style.width = 'calc(100% - 22px)';
                input.setAttribute('oninput', 'checkAnswerStatus()');
                // Pre-fill answer if it exists
                if (userAnswers[currentQuestionIndex]) {
                    input.value = userAnswers[currentQuestionIndex];
                }
                questionDiv.appendChild(input);
            } else if (q.type === 'matching') {
                const matchingDiv = document.createElement('div');
                matchingDiv.id = 'matching-options';
                q.pairs.forEach((pair, index) => {
                    const pairDiv = document.createElement('div');
                    pairDiv.classList.add('matching-pair');
                    const selectId = `matching-${currentQuestionIndex}-${index}`;
                    pairDiv.innerHTML = `
                        <span>${pair.left}</span>
                        <select id="${selectId}" onchange="checkAnswerStatus()">
                            <option value="">-- Select --</option>
                            ${pair.right.map(r => `<option value="${r}">${r}</option>`).join('')}
                        </select>
                    `;
                    matchingDiv.appendChild(pairDiv);
                    // Pre-fill answer if it exists
                    setTimeout(() => {
                        if (userAnswers[currentQuestionIndex] && userAnswers[currentQuestionIndex][pair.left]) {
                            document.getElementById(selectId).value = userAnswers[currentQuestionIndex][pair.left];
                        }
                    }, 0);
                });
                questionDiv.appendChild(matchingDiv);
            }

            questionContainer.appendChild(questionDiv);

            // Manage button visibility and state
            previousButton.style.display = currentQuestionIndex > 0 ? 'inline-block' : 'none';
            if (currentQuestionIndex === quizData.length - 1) {
                nextButton.style.display = 'none';
                submitButton.style.display = 'inline-block';
            } else {
                nextButton.style.display = 'inline-block';
                submitButton.style.display = 'none';
            }
            
            // Disable next/submit button until an answer is provided
            checkAnswerStatus();
        }

        /**
         * Checks if the current question has been answered and enables the next/submit button.
         */
        function checkAnswerStatus() {
            const q = quizData[currentQuestionIndex];
            let isAnswered = false;

            if (q.type === 'multiple-choice' || q.type === 'true-false') {
                isAnswered = document.querySelector(`input[name="answer"]:checked`) !== null;
            } else if (q.type === 'fill-in-the-blank' || q.type === 'short-answer' || q.type === 'case-study') {
                const textInput = document.getElementById('text-answer');
                isAnswered = textInput.value.trim() !== '';
            } else if (q.type === 'matching') {
                isAnswered = true; // Assume true, then check if any select is empty
                const selects = document.querySelectorAll(`#matching-options select`);
                selects.forEach(select => {
                    if (select.value === "") {
                        isAnswered = false;
                    }
                });
            }

            if (currentQuestionIndex === quizData.length - 1) {
                submitButton.disabled = !isAnswered;
            } else {
                nextButton.disabled = !isAnswered;
            }
        }

        /**
         * Saves the current answer and moves to the next question.
         */
        function nextQuestion() {
            if (!isCurrentQuestionAnswered()) {
                showModal("Please answer the current question before proceeding.");
                return;
            }
            saveAnswer();
            currentQuestionIndex++;
            loadQuestion();
        }

        /**
         * Saves the current answer and moves to the previous question.
         */
        function previousQuestion() {
            saveAnswer();
            currentQuestionIndex--;
            loadQuestion();
        }

        /**
         * Checks if the current question has been answered.
         */
        function isCurrentQuestionAnswered() {
            const q = quizData[currentQuestionIndex];
            if (q.type === 'multiple-choice' || q.type === 'true-false') {
                return document.querySelector(`input[name="answer"]:checked`) !== null;
            } else if (q.type === 'fill-in-the-blank' || q.type === 'short-answer' || q.type === 'case-study') {
                const textInput = document.getElementById('text-answer');
                return textInput.value.trim() !== '';
            } else if (q.type === 'matching') {
                const selects = document.querySelectorAll(`#matching-options select`);
                let answered = true;
                selects.forEach(select => {
                    if (select.value === "") {
                        answered = false;
                    }
                });
                return answered;
            }
            return false;
        }

        /**
         * Saves the user's answer for the current question.
         */
        function saveAnswer() {
            const q = quizData[currentQuestionIndex];
            if (q.type === 'multiple-choice' || q.type === 'true-false') {
                const selected = document.querySelector(`input[name="answer"]:checked`);
                if (selected) {
                    userAnswers[currentQuestionIndex] = selected.value;
                }
            } else if (q.type === 'fill-in-the-blank' || q.type === 'short-answer' || q.type === 'case-study') {
                const textInput = document.getElementById('text-answer');
                userAnswers[currentQuestionIndex] = textInput.value.trim();
            } else if (q.type === 'matching') {
                const matchingAnswers = {};
                q.pairs.forEach((pair, index) => {
                    const select = document.getElementById(`matching-${currentQuestionIndex}-${index}`);
                    matchingAnswers[pair.left] = select.value;
                });
                userAnswers[currentQuestionIndex] = matchingAnswers;
            }
        }

        /**
         * Handles the submission of the assessment.
         */
        function submitAssessment() {
            if (!isCurrentQuestionAnswered()) {
                showModal("Please answer the current question before submitting.");
                return;
            }
            saveAnswer();
            quizPage.style.display = 'none';
            resultPage.style.display = 'block';
            evaluateAnswers();
            generateReport();
        }

        /**
         * Compares user answers to correct answers and calculates the score.
         */
        function evaluateAnswers() {
            score = 0;
            quizData.forEach((q, index) => {
                const userAnswer = userAnswers[index];
                if (q.type === 'multiple-choice' || q.type === 'true-false') {
                    if (userAnswer === q.answer) {
                        score++;
                    }
                } else if (q.type === 'fill-in-the-blank' || q.type === 'short-answer' || q.type === 'case-study') {
                    if (userAnswer && userAnswer.toLowerCase() === q.answer.toLowerCase()) {
                        score++;
                    }
                } else if (q.type === 'matching') {
                    let correctPairs = 0;
                    let totalPairs = Object.keys(q.answers).length;
                    for (const key in q.answers) {
                        if (userAnswer && userAnswer[key] && userAnswer[key] === q.answers[key]) {
                            correctPairs++;
                        }
                    }
                    if (correctPairs === totalPairs) {
                        score++;
                    }
                }
            });
            document.getElementById('score').textContent = score;
        }

        /**
         * Generates the personalized report for the student.
         */
        function generateReport() {
            const topicScores = {};
            const topicCounts = {};
            
            // Calculate scores per topic
            quizData.forEach((q, index) => {
                const topic = q.topic;
                const userAnswer = userAnswers[index];
                if (!topicScores[topic]) {
                    topicScores[topic] = 0;
                    topicCounts[topic] = 0;
                }
                topicCounts[topic]++;

                if (q.type === 'multiple-choice' || q.type === 'true-false') {
                    if (userAnswer === q.answer) {
                        topicScores[topic]++;
                    }
                } else if (q.type === 'fill-in-the-blank' || q.type === 'short-answer' || q.type === 'case-study') {
                    if (userAnswer && userAnswer.toLowerCase() === q.answer.toLowerCase()) {
                        topicScores[topic]++;
                    }
                } else if (q.type === 'matching') {
                    let correctPairs = 0;
                    let totalPairs = Object.keys(q.answers).length;
                    for (const key in q.answers) {
                        if (userAnswer && userAnswer[key] && userAnswer[key] === q.answers[key]) {
                            correctPairs++;
                        }
                    }
                    if (correctPairs === totalPairs) {
                        topicScores[topic]++;
                    }
                }
            });

            let strengthsHTML = '<h4>Strengths</h4><p>Based on the performance, the student has demonstrated a strong understanding of the following areas:</p><ul>';
            let weaknessesHTML = '<h4>Weaknesses</h4><p>Additional practice is recommended in the following topics:</p><ul>';
            let feedback = 'Overall, the student has shown a good understanding of the material. ';

            // Determine strengths and weaknesses
            let strongTopics = [];
            let weakTopics = [];
            for (const topic in topicScores) {
                const percentage = (topicScores[topic] / topicCounts[topic]) * 100;
                if (percentage >= 80) {
                    strongTopics.push(topic);
                } else if (percentage < 50) {
                    weakTopics.push(topic);
                }
            }

            if (strongTopics.length > 0) {
                strengthsHTML += `<li>${strongTopics.join('</li><li>')}</li>`;
                feedback += `The student performed exceptionally well in **${strongTopics.join(', ')}**.`;
            } else {
                strengthsHTML += '<li>No specific strengths identified. Continued practice is encouraged.</li>';
                feedback += 'Continued practice across all topics will help to build a stronger foundation.';
            }

            if (weakTopics.length > 0) {
                weaknessesHTML += `<li>${weakTopics.join('</li><li>')}</li>`;
                feedback += ` It is recommended that the student receive additional support in **${weakTopics.join(', ')}**.`;
            } else {
                weaknessesHTML += '<li>No specific weaknesses identified.</li>';
                feedback += 'The student has a good grasp of the material across all topics.';
            }

            strengthsHTML += '</ul>';
            weaknessesHTML += '</ul>';

            document.getElementById('strengths-weaknesses').innerHTML = strengthsHTML + weaknessesHTML;
            document.getElementById('feedback').textContent = feedback;
            document.getElementById('parent-report').textContent = generateFormalReport(studentName);
        }
        
        /**
         * Generates the formal, positive parent report.
         * @param {string} name - The student's name.
         */
        function generateFormalReport(name) {
            return `Dear Guardian of ${name},

This report provides a formal overview of the recent ICT diagnostic assessment completed by ${name}. This assessment is strictly a diagnostic tool designed to evaluate the student's current proficiency and identify areas of strength and areas that may require further development. This is not a graded test and will not affect the student's academic standing.

The results of this assessment will be utilized by our instructional team to create a highly personalized learning plan for ${name}, ensuring that educational support is precisely tailored to their individual needs.

We appreciate ${name}'s diligent effort during this assessment. The requirement to answer each question before moving to the next encourages a focused and careful approach, and ${name} successfully demonstrated this commitment to the task.

The insights gained from this diagnostic will be invaluable in guiding future instruction and fostering continued academic growth. We look forward to partnering with you in ${name}'s educational journey.

Sincerely,
Mr. Usama Ibnzaid
Riyadh schools - Hittin`;
        }

        /**
         * Downloads the generated report as a text file.
         */
        function downloadReport() {
            const reportContent = `
ICT Diagnostic Assessment Report
Student: ${studentName}
Score: ${score} / ${quizData.length}

Strengths:
${document.getElementById('strengths-weaknesses').querySelector('h4').nextElementSibling.textContent}

Weaknesses:
${document.getElementById('strengths-weaknesses').querySelectorAll('h4')[1].nextElementSibling.textContent}

Constructive Feedback:
${document.getElementById('feedback').textContent}

Formal Report to Parent/Guardian:
${document.getElementById('parent-report').textContent}
            `;
            const blob = new Blob([reportContent], { type: 'text/plain' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `${studentName}_ICT_Assessment_Report.txt`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        /**
         * Simple modal for alerts, replacing the native alert() function.
         */
        function showModal(message) {
            const modal = document.createElement('div');
            modal.classList.add('modal');
            const modalContent = document.createElement('div');
            modalContent.classList.add('modal-content');
            modalContent.innerHTML = `
                <p>${message}</p>
                <button onclick="this.parentNode.parentNode.remove()">OK</button>
            `;
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
        }
    </script>
</body>
</html>
